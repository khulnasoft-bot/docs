---
title: 'Topics'
icon: 'people'
---

Teleflow offers a simple API providing an easy interface for triggering notifications to multiple subscribers at once. It is called Topics and allows the users to manage their bulk notifications without having to do complex loop implementations. A topic is identified by a custom key that is provided by the user. This custom key will be the identifier for the topic.

<Warning>
The topic key should be unique and can't be changed once chosen. Teleflow also safe guards for key uniqueness behind the scenes.
</Warning>

Users can also assign a name to a topic. This name doesn't need to be unique and it can be changed using the API. So far, it is for descriptive goals.

A topic would get assigned different subscribers that will receive a notification every time a notification is sent to the topic.

## Create A Topic

In order to be able to send a notification to a topic, first the user needs to create one. It can be done like this:

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const result = await teleflow.topics.create({
  key: 'unique-topic-identifier',
  name: 'descriptive-topic-name',
});
```

If successful this will return the internal Id generated by Teleflow and the topic key given by the user.

That topic key can be used to retrieve the whole Topic entity:

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const key = 'unique-topic-identifier';

const result = await teleflow.topics.get(key);
```

## Rename a Topic

Descriptive name given during creation of topic can be changed later. This can be done like this:

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const topicKey = 'posts:comment:12345';
const topicName = 'Post Comments';

const result = await teleflow.topics.rename(topicKey, topicName);
```

This will return the whole Topic information, including the subscribers if having any.

<Note>Topic Key can not be changed</Note>

## Add subscribers to a Topic

Adding subscribers to the topic is the main usecase of topic. A topic is like a group of subscribers. A notification can be sent to all subscribers of a topic at once

<Warning>
    Before adding subscribers to a topic, it's crucial to ensure that they are correctly identified in the Teleflow system. This identification is done using the [identify method](/subscribers/subscribers#create-a-subscriber) or API. When a subscriber is added to a topic, Teleflow uses the identification information to pick up the email or phone number associated with the subscriber. 
</Warning>

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const topicKey = 'posts:comment:12345';

const response = await teleflow.topics.addSubscribers(topicKey, {
  subscribers: ['subscriber-id-1', 'subscriber-id-2', ...],
});
```

This call will return a response in the shape of:

```typescript
{
    succeeded: ['subscriber-id-1', 'subscriber-id-2', ...],
    failed: {
      notFound: ['subscriber-id-1', 'subscriber-id-2', ...],
    },
}
```

The field `succeeded` will return the array of subscriber ids that have been correctly assigned to the topic. The field `failed` will show up only if there has been any subscriber that couldn't been assigned to the topic. This probably will happen if there is any typo in the given subscriberId or if the given subscriberId doesn't belong to the environment and the organization where the topic has been created.


### Create topic on the fly

To facilitate flows we allow to create a topic on the fly when adding subscribers. 

If the topic key used does not exist for the selected environment and organization, Teleflow will create a new topic with name `Autogenerated-<TOPIC_KEY>` and the subscribers will be assigned to this newly created topic. 

After that, that topic created on the fly can be managed in the same ways as the ones created in the normal way.

## Verify if subscriberId belongs to a topic

There would be times when it would be needed to verify if a certain subscriber belongs to a topic in order to decide what to do with that subscriber. The API call to achieve that is the following:

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const externalSubscriberId = 'external-subscriber-id-1';
const topicKey = 'posts:comment:12345';

const response = await teleflow.topics.getSubscriber(topicKey, externalSubscriberId);
```

<Note>
The subscriberId to use in this API call is the one used as subscriber identifier. 
The choice was made to make easier for the user to use this without making extra calls to Teleflow.
</Note>

## Remove a subscriber from a Topic

A single or group of subscribers can be removed from an existing topic.

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const topicKey = 'posts:comment:12345';

const response = await teleflow.topics.removeSubscribers(topicKey, {
  subscribers: ['subscriber-id-1', 'subscriber-id-2', ...],
});
```

Where `subscribers` will be an array of the subscriberIds we want to remove from the topic. If successful an empty response will be returned.

## Delete a topic

An existing topic can be deleted using topic-key as topic-key is the unique identifier for a topic.

```typescript
import { Teleflow } from '@teleflow/node';

const teleflow = new Teleflow("<TELEFLOW_API_KEY>");

const key = 'unique-topic-identifier';

const result = await teleflow.topics.delete(key);
```

<Warning>
A topic can only be deleted if it doesn't have any subscriber added. When trying to delete a topic with subscribers a conflict error will be returned. This is done to prevent accidental topic deletions.
</Warning>

## Trigger workflow to a topic

A workflow can be triggered to a single subscriber and an array of subscribers. While doing so, one need to send subscriberIds in `to` field. In case of trigger, we have already stored subscriberIds in a topic, so a topic key can be used to trigger a workflow. Workflow will be triggered to all subscribers in the topic.

```typescript
const topicKey = 'posts:comment:12345';

await teleflow.trigger('<WORKFLOW_TRIGGER_IDENTIFIER>', {
  to: [{ type: 'Topic', topicKey: topicKey }],
  payload: {},
});
```

## Trigger workflow to multiple topics

Workflow can be triggered to multiple subscribers by using an array of topics.

```typescript
const topicKey = '<TOPIC-KEY-DEFINED-BY-THE-USER>';

await teleflow.trigger('<WORKFLOW_TRIGGER_IDENTIFIER>', {
  to: [
    { type: 'Topic', topicKey: topicKey },
    { type: 'Topic', topicKey: 'Another Topic Key' },
  ],
  payload: {},
});
```

## Exclude actor from topic trigger event

To exclude the actor responsible for the action of a triggered topic event, you must add the subscriberId of that actor when triggering that event.

```typescript
const topicKey = 'posts:comment:12345';

await teleflow.trigger('<WORKFLOW_TRIGGER_IDENTIFIER>', {
  to: [{ type: 'Topic', topicKey: topicKey }],
  payload: {},
  actor: { subscriberId: '<SUBSCRIBER_ID_OF_ACTOR>' },
});
```

## Usecase Example

User X makes a comment, other users (A, B) who've already commented before should get a notification. So, when triggering the notification on that topic, you would usually want to exclude User X from receiving a notification about their own comment. To do that - you would need to add User X's subscriberId to the trigger event.

## API

<CardGroup cols={3}>
  <Card
    title="Fetch list of topics"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/filter-topics"
  ></Card>
  <Card
    title="Create a new topic"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/topic-creation"
  ></Card>
  <Card
    title="Add subscribers to a topic"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/subscribers-addition"
  ></Card>
    <Card
    title="Check if subscriber belongs to a topic"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/check-topic-subscriber"
  ></Card>
  <Card
    title="Remove subscribers from a topic"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/subscribers-removal"
  ></Card>
    <Card
    title="Fetch a topic by topic-key"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/get-topic"
  ></Card>
    <Card
    title="Delete a topic"
    icon="plug"
    color="#16a34a"
    href="/api-reference/topics/delete-topic"
  ></Card>
    <Card
    title="Rename a topic"
    icon="plug"
    color="#16a34a"
    href=" /api-reference/topics/rename-a-topic"
  ></Card>
</CardGroup>

## Frequently Asked Questions

<AccordionGroup>
  <Accordion title="Does it mean that all subscribers of one topic have same preference">
  No, adding subscribers into topic does not change subscriber's individual [subscriber preference](/subscribers/preferences). Topic is mainly used to group subscribers and fan out workflow triggered notifications to all subscribers at once.
  </Accordion>
</AccordionGroup>
